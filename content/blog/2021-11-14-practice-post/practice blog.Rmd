---
title: "Practice blog"
author: "Kundan K. Rao"
date: "15/11/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Bihar Assembly Election Analysis
```{r message=FALSE}
library(ggplot2)
library(plotly)
library(readxl)
library(dplyr)
```

## loading the Bihar Assambly Election Data
```{r}
dataset <- read_xls("D:/Academic/programming practice/R programming/R Markdown practice/Bihar Assembly Election 2020.xls")
#as.data.frame(dataset)
```


## Dataset of all the candidates
```{r}
my_state <- dataset[[1]][1]
dataset2 = filter(dataset,dataset$`STATE/UT NAME`== my_state)
#as.data.frame(dataset2)
```

## Dataset without NOTA
```{r}
dataset3 <- filter(dataset2, dataset2$PARTY !="NOTA")
#as.data.frame(dataset3)
```

## Dataset without Independent candidate and NOTA
```{r}
dataset4 <- filter(dataset3,dataset3$PARTY !="IND")
#as.data.frame(dataset4)
```

## summary of dataset without independent and nota candidates
```{r}
summary(as.data.frame(dataset4))  
```

## Catagory wise plot
```{r}
p1 <- ggplot(dataset3, aes(x = CATEGORY, y = ..count../sum(..count..) )) +
  geom_bar()+
  labs(x="Catagory",title="Bihar Assembly Election Candidates By Catagory.",y="Percentage Of Candidates")+
  scale_y_continuous(labels=scales::percent)
p1
```

## Gender Wise plot
```{r}
p2 <- ggplot(dataset3, aes(x = SEX,y = ..count../sum(..count..), fill=CATEGORY))+
  geom_bar(color="brown")+
  labs(x="Gender",title="Bihar Assembly Election Candidates By Gender.",y="Percentage Of Candidates")
p2
ggplotly(p2)
```

## Age distribution Gender wise
```{r}
p3 <- ggplot(dataset3, aes(x = SEX, y = AGE) )+
  geom_boxplot()
p3
```

## Age distribution category wise
```{r}
p4 <- ggplot(dataset3, aes(x=CATEGORY, y=AGE))+
  geom_boxplot()
p4
```

## Age distribution of big parties (Boxplot)
```{r}
Big_party_data <- filter(dataset3, dataset3$PARTY %in% c("BJP","JD(U)","RJD","INC","LJP","IND"))
p5 <- ggplot(Big_party_data,aes(x=PARTY,y=AGE))+ 
  geom_boxplot()
p5
ggplotly(p5)
```

## Age Distribution Of Big Parties (ridgesdensity plot)
```{r}
library(ggridges)
p6 <- ggplot(Big_party_data,aes(x=AGE,y=PARTY,fill=PARTY))+ 
  geom_density_ridges()+
  theme_ridges()
p6
```

## Number of Candidates Fielded by Canstituency
```{r}
AC_cand = as.data.frame(table(dataset3$`AC NAME`))
AC_cand
```

## Canstituency with minimum and maximum number of candidates
```{r}
min_can = min(AC_cand$Freq)
min_can_canst = as.data.frame(filter(AC_cand,AC_cand$Freq==min_can))
min_can_canst

max_can = max(AC_cand$Freq)
max_can_canst = as.data.frame(filter(AC_cand,AC_cand$Freq==max_can))
max_can_canst
```

## Winning Candidates data
```{r}
win_data <- as.data.frame(dataset3 %>% group_by(`AC NAME`) %>% filter(TOTAL==max(TOTAL)))
win_data[,c(2,3,4)]
```

## Winning Candidates party wise
```{r}
as.data.frame(table(win_data$PARTY))
```

## Winning candidates Gender Wise
```{r}
table(win_data$SEX)
(table(win_data$SEX)/length(win_data$SEX))*100
```

## Winning Candidates Catagory wise
```{r}
table(win_data$CATEGORY)
(table(win_data$CATEGORY)/length(win_data$CATEGORY))*100
```

## Number Of Candidates Fielded Party wise
```{r}
as.data.frame(table(dataset3$PARTY))
```

## Gender wie and partywise winning candidates
### FEMALES
```{r}
win_data_w <- win_data %>% group_by(PARTY) %>% filter(SEX=="FEMALE")
as.data.frame(table(win_data_w$PARTY))
```

### MALES-
```{r}
win_data_m <- win_data %>% group_by(PARTY) %>% filter(SEX=="MALE")
as.data.frame(table(win_data_m$PARTY))
```

